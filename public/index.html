<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Centered Flex Row Zoom + Hygraph</title>
  <style>
    * {
      box-sizing: border-box;
    }

    @font-face {
      font-family: "Ufficio600";
      src:
        url("/fonts/Ufficio-500.woff2") format("woff2"),
        url("/fonts/Ufficio-500.woff") format("woff");
      font-style: normal;
      font-display: swap;
    }
    ::-webkit-scrollbar {
display: none;
    }

    body {
      margin: 0;
      min-height: 3000vh; /* IMPORTANTE: serve altezza per poter scrollare in verticale */
      display: flex;
      flex-direction: column;
      align-items: center;
      background: rgb(233, 245, 255);
      color: #000;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      gap: 10rem;
      animation: backgroundIndex .6s ease 1.6s forwards;
    }

    @keyframes backgroundIndex {
      to {
        background: white;
      }
    }

    a{
      text-decoration: none;
      color: black;
      opacity:1;
      font-family: 'Ufficio600';
    }

    .frame {
      width: 100vw;
      overflow: visible;
      background: transparent;
      border-radius: 0;
      border: none;
      position: fixed;
      top: 40vh;
      transform-origin: top;
      animation: bottomMov 1s ease 1.5s forwards;

    }

    .fabioMenu{
      position: relative;
      display: flex;
      top: -2.6vw;
      width: 100%;
      transition: top 0.3s ease;
      box-shadow: 0px 1px 1px transparent;
      opacity: 0;
      animation: opacityIndex .6s ease-out 1.6s forwards;

    }

    .divMenu {
      width: 16.66%;
      font-size: 12px;
 opacity: 1;
   }

.divMenu a{
   transition: opacity .4s ease;
  }

    .divMenuRight {
      position: absolute;
      right: 0;
      font-size: 12px;
      text-align: end;
    }


    @keyframes bottomMov {
      to {
        top: calc(50vh - 15px)
      }
    }

    .frame.zoomed {
      overflow: hidden;
      border-radius: 16px;
    }

    .row {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 1500px;
      padding: 12px;
      padding-bottom: 5px;
      overflow-x: auto;
      overscroll-behavior-x: auto;
      animation: inlineGap .9s ease-out 0.2s forwards;
    }

    @keyframes inlineGap {
      to {
        gap: 5px;
      }
    }

    .LogoIndex{
      opacity:0;
      animation: opacityIndex .6s ease-out 1.6s forwards;
    }

    @keyframes opacityIndex {
      to {
        opacity: 1;
      }
    }

    .row.zoomed {
      overflow-x: auto;
      gap: 48px;
      padding: 24px;
      padding-bottom: 5px;
    }

    .row::-webkit-scrollbar {
      display: none;
    }
    .row::-webkit-scrollbar-track {
      background: none;
    }
    .row::-webkit-scrollbar-thumb {
      background: none;
    }

    .row img {
      flex: 0 0 auto;
      height: 10vh; /* small size */
      object-fit: cover;
      opacity: 0;
      animation:
        TallIndex 1s ease 1.2s forwards,
        opacityIndex 1s ease-out 0s forwards;
      transform-origin: top;
      filter: none;
      transition: filter 0.3s ease;
    }
     @keyframes TallIndex {
      to {
        height: 50vh;
      }
    }


     .socials {
    top: 47vH;
    width: 100%;
    position: fixed;
    display: flex;
    align-items: center;
    gap: 10px;
    padding-bottom: 8px;
    padding-left: 15px;
    font-family: "Ufficio600";
}

.socials {
    font-size: .7em;
    transition: .3s;
    transition-delay: .6s;
    opacity: 0;
    animation: opacityAnimation .4s 
ease-out 3s forwards;
}


@keyframes opacityAnimation {
  to {
    opacity: 1; /* posizione finale */
    
  }
}


.socials .copy {
    position: absolute;
    right: 15px;
}




    /* quando una QUALSIASI img √® in hover, tutte bright 0.7 */
    .row:has(img:hover) img {
      overflow: clip;
      filter: brightness(0.7);
    }

    /* tranne quella sotto il mouse */
    .row:has(img:hover) img:hover {
      filter: none;
    }

    .row.zoomed img {
      height: 42vh; /* zoomed size */
    }




  </style>
</head>
<body>
  <div style="position: fixed; top:0; left:0;padding: 10px;padding-inline: 15px;width: 100%;">
    <img src="../Asset4.svg" class="LogoIndex" />
    <div style="z-index: 999999;" class='fabioMenu' >
      <div class="divMenu">
        <a href="/info">INFO</a>
      </div>
      <div class="divMenu">
        <a href="https://cwkshop-2.myshopify.com/">SHOP</a>
      </div>
      <div class="divMenu">
        <a href="/archive">ARCHIVE</a>
      </div>
      <div class="divMenu divMenuRight">
        <a href="/subscribe">SUBSCRIBE</a>
      </div>
    </div>
  </div>

  <!-- questo blocco in HTML puro √® solo testo, lascialo o gestiscilo poi da JS/React -->
  <div class="socials">
    <a style="margin-right:10px">INSTAGRAM</a>
    <a style="margin-right:10px">YOUTUBE</a>
    <a style="margin-right:10px">THREADS</a>
    <a style="margin-right:10px">X</a>
    <p class="copy">¬©2025 Clare Waight Keller</p>
  </div>

  <div class="frame" id="frame">
    <div class="row" id="row">
      <!-- images injected from Hygraph -->
    </div>
  </div>

  <script>
    const HYGRAPH_ENDPOINT = "https://eu-west-2.cdn.hygraph.com/content/cmgfdcv2n007j07w3p805x60q/master";

    const QUERY = `
      query HomePages {
        homePages(first: 1, orderBy: updatedAt_DESC) {
          logoDesktop { url }
          logoMobile  { url }
          images (first:100){ id url }
          instagram
          threads
          x
          youtube
          copyright
        }
      }
    `;

    const row = document.getElementById("row");
    const frame = document.getElementById("frame");

    async function loadImages() {
      try {
        const res = await fetch(HYGRAPH_ENDPOINT, {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({ query: QUERY })
        });

        if (!res.ok) {
          console.error("Hygraph HTTP error:", res.status, res.statusText);
          return;
        }

        const json = await res.json();

        if (!json.data || !json.data.homePages || json.data.homePages.length === 0) {
          console.error("No homePages data from Hygraph", json);
          return;
        }

        const home = json.data.homePages[0];
        const images = home.images || [];

        if (!images.length) {
          console.warn("No images in homePages[0].images");
          return;
        }

        // pulisci eventuali contenuti
        row.innerHTML = "";

        // ripeti la sequenza di immagini 17 volte
        const fragment = document.createDocumentFragment();
        for (let repeat = 0; repeat < 17; repeat++) {
          images.forEach((imgObj) => {
            if (!imgObj || !imgObj.url) return;
            const img = document.createElement("img");
            img.src = imgObj.url;
            img.alt = imgObj.id || "";
            fragment.appendChild(img);
          });
        }
        row.appendChild(fragment);

      } catch (err) {
        console.error("Error fetching from Hygraph:", err);
      }
    }

    // üîÅ collega scroll verticale ‚Üí scroll orizzontale
    function setupVerticalToHorizontalScroll() {
      function updateHorizontalScroll() {
        const maxScrollY =
          document.documentElement.scrollHeight - window.innerHeight;
        const maxScrollX = row.scrollWidth - row.clientWidth;

        if (maxScrollY <= 0 || maxScrollX <= 0) return;

        const ratio = window.scrollY / maxScrollY; // 0 ‚Üí top, 1 ‚Üí bottom
        row.scrollLeft = maxScrollX * ratio;
      }

      window.addEventListener("scroll", updateHorizontalScroll);
      // chiamata iniziale per sincronizzare
      updateHorizontalScroll();
    }

    window.addEventListener("load", () => {
      loadImages().then(() => {
        setupVerticalToHorizontalScroll();
      });
    });





    document.addEventListener("DOMContentLoaded", () => {
  const links = document.querySelectorAll(".fabioMenu a");

  links.forEach(link => {
    link.addEventListener("mouseenter", () => {
      links.forEach(l => {
        if (l !== link) l.style.opacity = "0.2";
      });
    });

    link.addEventListener("mouseleave", () => {
      links.forEach(l => {
        l.style.opacity = "1";
      });
    });
  });
});
  </script>
</body>
</html>
